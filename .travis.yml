sudo: required
dist: trusty

language: node_js
node_js:
- '6.1'

before_install:
- sudo apt-get -qq update
- sudo apt-get install -y osmosis
- cp -r $(pwd)/test/fixtures/data $(pwd)/web/data
- chmod a+x ./test/*.sh
- ./test/install-osrm.sh &
- ./test/prepare-test.sh

install:
- npm install

before_script:
- node index.js &

after_script: NODE_ENV=test `npm bin`/istanbul cover `npm bin`/_mocha --report lcovonly -- -R spec && cat ./coverage/lcov.info | ./node_modules/coveralls/bin/coveralls.js && rm -rf ./coverage
